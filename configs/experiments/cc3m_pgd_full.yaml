# CC3M + PGD + 完整防御实验配置
name: "cc3m_pgd_full_experiment"
description: "Complete experiment: CC3M dataset + PGD attack + full defense (TVC + GenRef)"
version: "1.0"

# 继承基础配置
inherits:
  - "../default.yaml"
  - "../datasets/cc3m.yaml"
  - "../attacks/pgd.yaml"
  - "../defenses/base.yaml"

# 实验特定覆盖配置
overrides:
  # 数据集配置覆盖
  dataset:
    loading:
      batch_size: 64  # CC3M可以使用较大batch size
    splits:
      test:
        size: 2000  # 使用较大子集进行实验
      
  # 攻击配置覆盖
  attack:
    attack_params:
      num_steps: 500  # 减少迭代步数以平衡效果和效率
      epsilon: 0.03137  # 8/255
      alpha: 0.005     # 步长
      early_stop: true
      success_threshold: 0.95
    batch:
      size: 32  # 适应CC3M的批大小
      
  # 防御配置覆盖
  defense:
    text_variants:
      enabled: true
      num_variants: 5
      strategies: ["synonym", "paraphrase", "reorder"]
    generative_reference:
      enabled: true
      num_references: 3
    detector:
      weights:
        direct_consistency: 0.25
        text_variant_consistency: 0.35
        generative_reference_consistency: 0.4

# 实验流程配置
workflow:
  stages:
    - "data_preparation"
    - "attack_generation"
    - "defense_evaluation"
    - "metrics_calculation"
    - "visualization"

# 评估指标
metrics:
  - "attack_success_rate"
  - "defense_success_rate"
  - "top_k_retrieval_accuracy"
  - "detection_rate"
  - "false_positive_rate"
  - "computational_overhead"

# 输出配置
output:
  save_adversarial_samples: true
  save_detection_results: true
  save_metrics: true
  generate_visualizations: true
  results_dir: "results/cc3m_pgd_full"